import{r as d,j as c}from"./index--d6C-o60.js";import{c as y}from"./index-cDQ92vS3.js";const U=()=>{const p=d.useRef(null),u=d.useRef(null),[k,m]=d.useState([]),[l,f]=d.useState(!1),v=30;d.useEffect(()=>{let e,t=0;return l&&(e=setInterval(()=>{if(t>=v){f(!1);return}const a=p.current,n=u.current,r=n.getContext("2d");n.width=a.videoWidth,n.height=a.videoHeight,r.drawImage(a,0,0,n.width,n.height);const s=n.toDataURL("image/jpeg"),i=j(n);m(g=>[...g,{original:s,sketch:i}]),t++},2e3)),()=>{e&&clearInterval(e)}},[l]);const j=e=>{const t=document.createElement("canvas"),o=t.getContext("2d");t.width=e.width,t.height=e.height,o.drawImage(e,0,0),w(o,t);const a=o.getImageData(0,0,t.width,t.height);return C(a,t.width,t.height),o.putImageData(a,0,0),t.toDataURL("image/png")},w=(e,t)=>{const o=e.getImageData(0,0,t.width,t.height),a=o.data;for(let n=0;n<a.length;n+=4){const r=a[n],s=a[n+1],i=a[n+2];r>200&&s>200&&i>200&&(a[n]=255,a[n+1]=255,a[n+2]=255,a[n+3]=255)}e.putImageData(o,0,0)},C=(e,t,o)=>{const a=new Uint8ClampedArray(e.data.length/4);for(let r=0;r<a.length;r++){const s=e.data[r*4],i=e.data[r*4+1],g=e.data[r*4+2];a[r]=(s+i+g)/3}const n=128;for(let r=0;r<o;r++)for(let s=0;s<t;s++){const i=(r*t+s)*4,h=a[r*t+s]>n?255:0;e.data[i]=h,e.data[i+1]=h,e.data[i+2]=h}},I=e=>{const t=e.target.files[0];if(t){const o=URL.createObjectURL(t);p.current.src=o}},S=()=>{f(!l),l||m([])},x=(e,t)=>{const o=document.createElement("a");o.href=e,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o)};return c.jsxs("div",{children:[c.jsx("input",{type:"file",accept:"video/*",onChange:I}),c.jsx("video",{ref:p,controls:!0,style:{display:"block",maxWidth:"100%",marginBottom:"10px"}}),c.jsx("button",{onClick:S,children:l?"Stop Capturing":"Start Capturing"}),c.jsx("canvas",{ref:u,style:{display:"none"}}),c.jsx("div",{style:{display:"flex",flexWrap:"wrap",marginTop:"20px"},children:k.map((e,t)=>c.jsxs("div",{style:{margin:"10px",textAlign:"center"},children:[c.jsx("img",{src:e.original,alt:`Original ${t}`,style:{width:"200px",marginBottom:"5px"}}),c.jsx(y,{onClick:()=>x(e.original,`original-${t}.jpg`),style:{cursor:"pointer",fontSize:"20px",marginBottom:"10px"},title:"Download Original"}),c.jsx("img",{src:e.sketch,alt:`Sketch ${t}`,style:{width:"200px",marginTop:"10px",marginBottom:"5px"}}),c.jsx(y,{onClick:()=>x(e.sketch,`sketch-${t}.png`),style:{cursor:"pointer",fontSize:"20px",marginBottom:"10px"},title:"Download Sketch"})]},t))})]})};export{U as default};
